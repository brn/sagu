!function(e){"use strict";function r(e,r,n){function t(){for(var e in o)o[e]()}function a(e,r){return function(n){var a=e?{event:n,error:null}:{event:null,error:n},o=babelHelpers.extends({},a,{type:r,dispose:t});e&&c?c(o):u.push(o)}}var u=[],c=null,o={};return(Array.isArray(r)?r:[r]).forEach(function(r,t){r&&(r=r.trim(),o[r]=n(e,r,a(!0,r),a(!1,r)))}),function(){return new Promise(function(e){u.length?e(u.shift()):c=function(r){c=null,e(r)}})}}function n(e,r){return c.call(e,r)}function t(e,n,t){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(e){return new WebSocket(e)},u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:["onopen","onmessage"],c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:["onerror"];return r(a(e),u.concat(c),function(e,r,a,u){return c.indexOf(r)>-1?n(e,r,u):n(e,r,a),function(){return t(e,r,a,u)}})}function a(e){return t(e,function(e,r,n){return e[r]=n},function(e,r,n){return e[r]=null})}function u(e,r,n){return t(e,function(e,r,n){return e.on(r,n)},function(e,r,n){return e.off(r,n)},n,(Array.isArray(r)?r:[r]).concat(["connect","event","disconnect","ping","pong","reconnect","reconnect_attempt","reconnecting"]),["error","connect_error","connect_timeout","reconnect_error","reconnect_failed"])}var c=Element.prototype.matches||Element.prototype.matchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector||Element.prototype.webkitMatchesSelector||function(e){for(var r=(this.document||this.ownerDocument).querySelectorAll(e),n=r.length;--n>=0&&r.item(n)!==this;);return n>-1},o=function(){var e=babelHelpers.asyncGenerator.wrap(regeneratorRuntime.mark(function e(t,a){var u,c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:u=r("string"==typeof t?document.querySelector(t):t,a,function(e,r,a){var u=c?function(e){n(e.target,c)&&a(e)}:a;return t.addEventListener(r,u,!1),function(){return t.removeEventListener(r,u)}});case 1:return e.next=4,babelHelpers.asyncGenerator.await(u());case 4:return e.next=6,e.sent;case 6:e.next=1;break;case 8:case"end":return e.stop()}},e,this)}));return function(r,n){return e.apply(this,arguments)}}(),s=function(){var e=babelHelpers.asyncToGenerator(regeneratorRuntime.mark(function e(r){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise(function(e){return setTimeout(function(){return e(n)},r)});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)}));return function(r){return e.apply(this,arguments)}}(),i=function(){var e=babelHelpers.asyncGenerator.wrap(regeneratorRuntime.mark(function e(r){var n,t,a=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=!0,t=0;case 2:if(!n||!a){e.next=9;break}return e.next=6,t++;case 6:n=!1,e.next=13;break;case 9:return e.next=11,babelHelpers.asyncGenerator.await(s(r,t++));case 11:return e.next=13,e.sent;case 13:e.next=2;break;case 15:case"end":return e.stop()}},e,this)}));return function(r){return e.apply(this,arguments)}}(),f=function(){var e=babelHelpers.asyncGenerator.wrap(regeneratorRuntime.mark(function e(){var r,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=n;case 1:return e.next=4,r++;case 4:e.next=1;break;case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),l=function(){var e=babelHelpers.asyncGenerator.wrap(regeneratorRuntime.mark(function e(n,t){var a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a=r(n,t,function(e,r,t){return n.on(r,t),function(){return n.off(r,t)}});case 1:return e.next=4,a();case 4:e.next=1;break;case 6:case"end":return e.stop()}},e,this)}));return function(r,n){return e.apply(this,arguments)}}(),p=function(){var e=babelHelpers.asyncGenerator.wrap(regeneratorRuntime.mark(function e(r){var n,t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=r.body.getReader();case 1:return e.next=4,babelHelpers.asyncGenerator.await(n.read());case 4:return t=e.sent,e.next=7,{chunk:t,reader:n};case 7:e.next=1;break;case 9:case"end":return e.stop()}},e,this)}));return function(r){return e.apply(this,arguments)}}(),b=function(){var e=babelHelpers.asyncGenerator.wrap(regeneratorRuntime.mark(function e(r,n){var t,a,u,c,o,s,i,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=!0,a=!1,u=void 0,e.prev=3,c=babelHelpers.asyncIterator(f(l,!0));case 5:return e.next=7,babelHelpers.asyncGenerator.await(c.next());case 7:return o=e.sent,t=o.done,e.next=11,babelHelpers.asyncGenerator.await(o.value);case 11:if(s=e.sent,t){e.next=21;break}return i=s,e.next=16,babelHelpers.asyncGenerator.await(fetch(r,n).then(function(e){return e.ok?{ok:!0,response:e}:{ok:!1,error:e}},function(e){return{ok:!1,error:e}}));case 16:return e.next=18,e.sent;case 18:t=!0,e.next=5;break;case 21:e.next=27;break;case 23:e.prev=23,e.t0=e.catch(3),a=!0,u=e.t0;case 27:if(e.prev=27,e.prev=28,t||!c.return){e.next=32;break}return e.next=32,babelHelpers.asyncGenerator.await(c.return());case 32:if(e.prev=32,!a){e.next=35;break}throw u;case 35:return e.finish(32);case 36:return e.finish(27);case 37:case"end":return e.stop()}},e,this,[[3,23,27,37],[28,,32,36]])}));return function(r,n){return e.apply(this,arguments)}}(),h=function(){var e=babelHelpers.asyncGenerator.wrap(regeneratorRuntime.mark(function e(n,t){var a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a=r(new EventSource(n),t,function(e,r,n){return e.addEventListener(r,n,!1),function(){return e.removeEventListener(r,n)}});case 1:return e.next=4,babelHelpers.asyncGenerator.await(a());case 4:return e.next=6,e.sent;case 6:e.next=1;break;case 8:case"end":return e.stop()}},e,this)}));return function(r,n){return e.apply(this,arguments)}}(),v=function(){var e=babelHelpers.asyncGenerator.wrap(regeneratorRuntime.mark(function e(r,n){var t,c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=void 0,c){e.next=7;break}if(!n){e.next=4;break}throw new Error("Native WebSocket can't specify events parameter.");case 4:t=a(r),e.next=8;break;case 7:t=u(r,n,c);case 8:return e.next=11,babelHelpers.asyncGenerator.await(t());case 11:return e.next=13,e.sent;case 13:e.next=8;break;case 15:case"end":return e.stop()}},e,this)}));return function(r,n){return e.apply(this,arguments)}}(),k=function(){var e=babelHelpers.asyncToGenerator(regeneratorRuntime.mark(function e(r,n){var t,a,u,c,o,i,l,p,b=n.options,h=void 0===b?{}:b,v=n.timing,k=void 0===v?function(){return 1e3}:v,x=n.limit,d=void 0===x?5:x,y=n.isFailed,w=void 0===y?function(e){return!e.ok}:y;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=!0,a=!1,u=void 0,e.prev=3,c=babelHelpers.asyncIterator(f(1));case 5:return e.next=7,c.next();case 7:return o=e.sent,t=o.done,e.next=11,o.value;case 11:if(i=e.sent,t){e.next=28;break}return l=i,e.next=16,fetch(r,h).catch(function(e){return e});case 16:if(!(p=e.sent)||w(p)){e.next=21;break}return e.abrupt("return",{ok:!0,response:p});case 21:if(!(l>d)){e.next=23;break}return e.abrupt("return",{ok:!1,response:p});case 23:return e.next=25,s(k(l));case 25:t=!0,e.next=5;break;case 28:e.next=34;break;case 30:e.prev=30,e.t0=e.catch(3),a=!0,u=e.t0;case 34:if(e.prev=34,e.prev=35,t||!c.return){e.next=39;break}return e.next=39,c.return();case 39:if(e.prev=39,!a){e.next=42;break}throw u;case 42:return e.finish(39);case 43:return e.finish(34);case 44:case"end":return e.stop()}},e,this,[[3,30,34,44],[35,,39,43]])}));return function(r,n){return e.apply(this,arguments)}}(),x=function(){function e(r){babelHelpers.classCallCheck(this,e),this._buffer=[],this._isBinary=r,this._locked=!1}return babelHelpers.createClass(e,[{key:"enqueu",value:function(e){this._buffer.push(e)}},{key:"readAll",value:function(){var r=e.concat(this._buffer);return this._isBinary?r:this.toString()}},{key:"toString",value:function(){return this._isBinary?e.conat(this._buffer).toString():e.convertUint8ArrayToUtfString(e.concat(this._buffer))}}],[{key:"concat",value:function(e){var r=e.reduce(function(e,r){return e+r.length},0),n=0;return e.reduce(function(e,r){return e.set(r,n),n+=r.length,e},new Uint8Array(r))}},{key:"convertUint8ArrayToUtfString",value:function(e){for(var r=[],n=0,t=e.length;n<t;){var a=e[n++],u=a>>4;if(u>=0&&u<=7)r.push(String.fromCharCode(a));else if(u>=12&&u<=13){var c=e[n++];r.push(String.fromCharCode((31&a)<<6|63&c))}else if(14===u){var o=e[n++],s=e[n++];r.push(String.fromCharCode((15&a)<<12|(63&o)<<6|(63&s)<<0))}}return r.join("")}}]),e}(),d=function(){function e(r){var n=r.chunk,t=r.buffer,a=r.reader;babelHelpers.classCallCheck(this,e),this._chunk=n,this._buffer=t,this._reader=a}return babelHelpers.createClass(e,[{key:"read",value:function(){return this._chunk}},{key:"isBuffered",value:function(){return!!this._buffer}},{key:"drainBuffer",value:function(){return this._buffer?this._buffer.readAll():null}},{key:"cancel",value:function(){this._reader.cancel()}}]),e}(),y=!!window.ReadableStream&&!!window.WritableStream,w=window.Uint8Array?new Uint8Array(new ArrayBuffer(0)):null,m=new d({chunk:null,buffer:null,reader:null,ok:!1,done:!0}),g=function(){var e=babelHelpers.asyncGenerator.wrap(regeneratorRuntime.mark(function e(r,n){var t,a,u,c,o,s,i,f,l,b,h,v,g,H,G,R,_=n.binary,S=void 0!==_&&_,E=n.buffering,A=void 0===E||E,C=babelHelpers.objectWithoutProperties(n,["binary","buffering"]);return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(y){e.next=2;break}throw new Error("Stream not supported in this environment!");case 2:return e.next=4,babelHelpers.asyncGenerator.await(k(r,C));case 4:if(t=e.sent,a=t.ok,u=t.response,a){e.next=9;break}return e.abrupt("return",m);case 9:c=A?new x(S):null,o=!0,s=!1,i=void 0,e.prev=13,f=babelHelpers.asyncIterator(p(u));case 15:return e.next=17,babelHelpers.asyncGenerator.await(f.next());case 17:return l=e.sent,o=l.done,e.next=21,babelHelpers.asyncGenerator.await(l.value);case 21:if(b=e.sent,o){e.next=37;break}if(h=b,v=h.chunk,g=v.value,H=v.done,G=h.reader,!H){e.next=31;break}R=Object.freeze({chunk:new d({chunk:w,buffer:c,reader:G}),ok:a,done:H});case 26:return e.next=29,R;case 29:e.next=26;break;case 31:return A&&c.enqueu(g),e.next=34,Object.freeze({chunk:new d({chunk:g,buffer:c,reader:G}),ok:a,done:H});case 34:o=!0,e.next=15;break;case 37:e.next=43;break;case 39:e.prev=39,e.t0=e.catch(13),s=!0,i=e.t0;case 43:if(e.prev=43,e.prev=44,o||!f.return){e.next=48;break}return e.next=48,babelHelpers.asyncGenerator.await(f.return());case 48:if(e.prev=48,!s){e.next=51;break}throw i;case 51:return e.finish(48);case 52:return e.finish(43);case 53:case"end":return e.stop()}},e,this,[[13,39,43,53],[44,,48,52]])}));return function(r,n){return e.apply(this,arguments)}}();e.event=o,e.wait=s,e.intervals=i,e.infinity=f,e.emitter=l,e.poll=b,e.sse=h,e.ws=v,e.retryable=k,e.Buffer=x,e.stream=g}(this.sagu=this.sagu||{});
